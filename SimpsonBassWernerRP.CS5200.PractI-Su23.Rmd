---
title: "Practicum I CS5200"
authors: "Rupert Simpson, Paula Bass Werner"
date: "Summer Full 2023"
output: html_notebook
---

## Connect to Database

```{r ConnectToDatabase, eval = T, warning = F}
library(RMySQL)

host <- "sql9.freemysqlhosting.net"
username <- "sql9627585"
password <- "2JUXlIEk39"
dbname <- "sql9627585"

dbcon <- dbConnect(
  MySQL(),
  user = username,
  password = password,
  dbname = dbname,
  host = host
)
```

## Create Database

```{sql CreateAirportsTable, connection=dbcon}
CREATE TABLE IF NOT EXISTS airports (
  aid INT PRIMARY KEY AUTO_INCREMENT,
  airportState TEXT,
  airportCode TEXT
);
```

```{sql CreateFlightTable, connection=dbcon}
CREATE TABLE IF NOT EXISTS flights (
  fid INT PRIMARY KEY,
  date DATE,
  origin INT,
  airline TEXT,
  aircraft TEXT,
  altitude INT,
  heavy BOOLEAN,
  FOREIGN KEY (origin) REFERENCES airports(aid)
);
```

```{sql CreateConditionsTable, connection=dbcon}
CREATE TABLE IF NOT EXISTS conditions (
  cid INT PRIMARY KEY,
  sky_condition TEXT,
  explanation TEXT
);
```

```{sql CreateStrikesTable, connection=dbcon}
CREATE TABLE IF NOT EXISTS strikes (
  sid INT PRIMARY KEY AUTO_INCREMENT,
  fid INT,
  numbirds INT,
  impact TEXT,
  damage BOOLEAN,
  altitude INT CHECK (altitude >= 0),
  conditions INT,
  FOREIGN KEY (conditions) REFERENCES conditions(cid),
  FOREIGN KEY (fid) REFERENCES flights(fid)
);
```



```{sql airportsTableInsertTest, connection=dbcon, eval=F}
INSERT INTO airports (airportState, airportCode)
VALUES ('California', 'LAX');
```

```{sql airportsTableOutputTest, connection=dbcon, eval=F}
SELECT * FROM airports;
```

```{sql flightsTableInsertTest, connection=dbcon, eval=F}
INSERT INTO flights (fid, date, origin, airline, aircraft, altitude, heavy)
VALUES (1, '2023-06-21', 1, 'Delta', 'Boeing 737', 35000, 1);
```

```{sql flightsTableOutputTest, connection=dbcon, eval=F}
SELECT * FROM flights;
```

```{sql conditionsTableInsertTest, connection=dbcon, eval=F}
INSERT INTO conditions (cid, sky_condition, explanation)
VALUES (1, 'Clear', 'No clouds in the sky.');
```

```{sql conditionsTableOutputTest, connection=dbcon, eval=F}
SELECT * FROM conditions;
```

```{sql strikesTableInsertTest, connection=dbcon, eval=F}
INSERT INTO strikes (fid, numbirds, impact, damage, altitude, conditions)
VALUES (1, 2, 'Engine failure', true, 30000, 1);
```

```{sql strikesTableOutputTest, connection=dbcon, eval=F}
SELECT * FROM strikes;
```

```{sql strikesTableReset, connection=dbcon, eval=F}
DELETE FROM strikes;
```

```{sql flightsTableReset, connection=dbcon, eval=F}
DELETE FROM flights;
```

```{sql airportsTableReset, connection=dbcon, eval=F}
DELETE FROM airports;
```

```{sql conditionsTableReset, connection=dbcon, eval=F}
DELETE FROM conditions;
```

```{sql connection=dbcon, eval=F}
ALTER TABLE airports AUTO_INCREMENT = 1;
```

```{sql airportPrimaryKeyReset, connection=dbcon, eval=F}
ALTER TABLE strikes AUTO_INCREMENT = 1;
```

```{sql strikesPrimaryKeyReset, connection=dbcon, eval=F}
ALTER TABLE strikes AUTO_INCREMENT = 1;
```

## Disconnect From Database

```{r}
dbDisconnect(dbcon)
```